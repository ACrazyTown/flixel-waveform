name: CI

on: [push, pull_request, workflow_dispatch]

jobs:
    test-cpp:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            - uses: krdlab/setup-haxe@v1
              with:
                haxe-version: 4.3.6

            - name: Install dependencies
              run: |
                haxelib install lime --quiet
                haxelib install openfl --quiet
                haxelib install flixel --quiet
                haxelib install flixel-ui --quiet
                haxelib git hxcpp https://github.com/HaxeFoundation/hxcpp --quiet

            - name: Build sample
              run: |
                cd samples/basic
                haxelib run lime build linux
                cd ../..

    test-hl:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            - uses: krdlab/setup-haxe@v1
              with:
                haxe-version: 4.3.6

            - name: Install dependencies
              run: |
                haxelib install lime --quiet
                haxelib install openfl --quiet
                haxelib install flixel --quiet
                haxelib install flixel-ui --quiet

            - name: Build sample
              run: |
                cd samples/basic
                haxelib run lime build hl
                cd ../..

    test-html5:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            - uses: krdlab/setup-haxe@v1
              with:
                haxe-version: 4.3.6

            - name: Install dependencies
              run: |
                haxelib install lime --quiet
                haxelib install openfl --quiet
                haxelib install flixel --quiet
                haxelib install flixel-ui --quiet

            - name: Build sample
              run: |
                cd samples/basic
                haxelib run lime build html5
                cd ../..

    test-flash:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            - uses: krdlab/setup-haxe@v1
              with:
                haxe-version: 4.3.6

            - name: Install dependencies
              run: |
                haxelib install lime --quiet
                haxelib install openfl --quiet
                haxelib install flixel --quiet
                haxelib install flixel-ui --quiet

            - name: Build sample
              run: |
                cd samples/basic
                haxelib run lime build flash
                cd ../..
                
